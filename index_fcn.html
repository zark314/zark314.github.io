<!DOCTYPE HTML>
<html>
    <head>
        <title>噴噴噴技能序列搜索器</title>
        <link rel="icon" href="icon/star.ico">
	</head>
    <script>
        var MAX_STEP = 30;
        var BrandName = [
        "戰鬥魷魚 / SquidForce",
        "鋼鐵先鋒 / Zink",
        "海月 / Krak-On",
        "羅肯貝格 / Rockenberg",
        "澤酷 / Zekko",
        "鍛品 / Forge",
        "暖流 / Firefin",
        "帆立 / Skalop",
        "寺門 / Splash Mob",
        "時雨 / Inkline",
        "艾洛眼 / Tentatek",
        "暇古 / Takoroka",
        "無法無天 / Annaki",
        "魷皇 / Enperry",
        "劍尖魷 / Toni Kensa",
        "散壽司 / Barazushi",
        "七輪 / Emberz",
        "熊先生商會 / Grizzco",
        "魚幹製造 / Cuttlegear",
        "amiibo"
        ];

        var AbilityName = [
        "主省 / 提升墨汁效率(主要武器)",
        "副省 / 提升墨汁效率(次要武器)",
        "墨回 / 提升墨汁槽的回復速度",
        "走速 / 提升人類狀態移動速度",
        "遊速 / 提升魷魚遊動速度",
        "大招減量 / 提升特殊武器增加量",
        "sp死亡減輕 / 降低特殊武器減少量",
        "大招增強 / 提升特殊武器的性能",
        "快速復活 / 縮短復活時間",
        "超級跳 / 縮短超級跳躍的時間",
        "副強 / 提升次要武器的性能",
        "安全鞋 / 減輕對手墨汁影響",
        "防爆 / 減輕次要武器影響",
        "行動強化"
        ];
        var TargetCode = new Array(3);
        var BrandTend = [11, 0, 9, 8, 4, 12, 3, 4, 6, 5, 7, 1, 1, 2, 8, 6, 0, 3, 12, 13, 
        2, 9, 5, 7, 1, 6, 10, 11, 0, 10, 13, 10, 13, 5, -1, -1, -1, -1, -1, -1];

        var ddrinklist = [0, 0, 0, 0, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0];
        class GearAbility{
            constructor(Ability, Seed, Brand){
                this.Ability = Ability;
                this.Brand = Brand;
                this.Seed = Seed;
            }
            GetNextAbility(Drink){
                this.Seed = GetNextSeed(this.Seed);
                if(Drink < 0 || Drink > 13){
                    this.Ability = GetSeedAbility(this.Seed, this.Brand, -1);
                    return this;
                }
                if(this.Seed % 100 < 30){
                    this.Ability = Drink;
                    return this;
                }
                this.Seed = GetNextSeed(this.Seed);
                this.Ability = GetSeedAbility(this.Seed, this.Brand, Drink);
                return this;
            }
        }
        class PlanResult{
            constructor(StepNum, StepSeed, DrinkNum){
                this.StepNum = StepNum;
                this.StepSeed = StepSeed;
                this.DrinkNum = DrinkNum;
            }
        }
        function GetSeedAbility(Seed, Brand, Drink){
            let AllWeight;
            let Stend = BrandTend[Brand * 2];
            let Wtend = BrandTend[Brand * 2 + 1];

            if(Stend == -1){
                if(Drink < 0 || Drink > 13) AllWeight = 28;
                else    AllWeight = 26;
            }else{
                if(Drink == Stend)  AllWeight = 25;
                else if(Drink == Wtend)  AllWeight = 34;
                else if(Drink < 0 || Drink > 13)    AllWeight = 35;
                else AllWeight = 33;
            }
            let Weight = Seed % AllWeight;

            for(var temp = 0; temp < 14 ; temp++){
                if(temp == Drink)   continue;
                else if(temp == Wtend)    Weight = Weight - 1;
                else if(temp == Stend)    Weight = Weight - 10;
                else    Weight = Weight - 2;
                if(Weight < 0)  return temp;
            }
            
        }

        function GetNextSeed(Seed){
            Seed ^= (Seed << 13);
            Seed ^= (Seed >>> 17);
            Seed ^= (Seed << 5);
            Seed = Seed >>> 0;
            return Seed;
        }

        function SeedFindAll(Seed){
            
        }
        function SeedFindN(Seed, drink, Target){
            let drinktmp = drink;
            if(drinktmp < 0)  drinktmp = 14;
            for(let temp = 0; temp < AbilityName.length + 1; temp++){

                if(ddrinklist[(temp + drink) % 15] == 1)   continue;

                let SeedNTemp = copyobj(Seed);
                SeedNTemp.GetNextAbility((temp + drink) % 15);
                let matchability = SeedNTemp.Ability;
                let matchtemp = Matchcode(matchability, Target);
                if(matchtemp[0] != -2){
                    return (temp + drink) % 15;
                }
            }
            return -2;
        }
        function SeedFindNN(Seed, drink, matchcc){
            let cost1 = -2;
            let cost2 = -2;
            if(drink < 0)   drink = 14;
            for(let temp = 0; temp < AbilityName.length + 1; temp++){

                if(ddrinklist[(temp + drink) % 15] == 1)   continue;

                let SeedT = copyobj(Seed);
                var matchability = (SeedT.GetNextAbility((temp + drink) % 15)).Ability;
                var matchccc = Matchcode(matchability, matchcc);
                if(matchccc[0] != -2){
                    cost1 = (temp + drink) % 15;
                    if(matchccc[0] > -1 || matchccc[1] > -1 ||matchccc[2] > -1){
                        cost2 = SeedFindN(SeedT, (temp + drink) % 15, matchccc);
                        if(cost2 == -2) return [-2,-2];
                    }
                    return [cost1, cost2];
                }
            }
            return [-2,-2];
        }

        function CostNumCalcu(drink, cost, OStep, BStep){
            var res = new Array(4);
            let resnum = 0;
            if(drink > -1 && drink < 14){
                resnum ++;
            }    
            if(cost[0] != drink && cost[0] > -1 && cost[0] < 14){
                resnum++;
            }
            if(cost[0] != cost[1] && cost[1] > -1 && cost[1] < 14){
                resnum ++;
            }
            res[0] = resnum;
            res[1] = drink;
            res[2] = cost[0];
            res[3] = cost[1];
            return res;
        }

        function cleartable(){
            for(let temp = 0; temp < 9; temp++){
                IDtable0  = document.getElementById('IDtable' + temp);
                tab = '';
                IDtable0.innerHTML = tab;
            }
        }

        function Matchcode(ability, targets){
            res = new Array(3);
            res[0] = targets[0];
            res[1] = targets[1];
            res[2] = targets[2];
            for(let temp = 0; temp < 3; temp++){
                if(ability == res[temp]){
                    res[temp] = -1;
                    return res;
                }
            }
            return [-2, -2, -2];
        }

        function TargetCodeNum(TargetCode){
            let res = 0;
            for(let temp = 0; temp < 3; temp++){
                if(TargetCode[temp] > -1){
                    res ++;
                }
            }
            return res;
        }

        function SeedFind(Seed, TargetCode, IsFindAll){
            var drinkjump = parseInt(document.getElementById('DrinkJump').value);
            var SeedOri = copyobj(Seed);
            var CostNum = new Array();
            var CostNumP = 4;
            var PlanNum = 0;
            var ResStep = new Array(MAX_STEP);
            var isfirst = 1;
            var tablenum = 0;
            for(var OriginStep = 0; OriginStep < MAX_STEP ; OriginStep ++){

                for(var BranceStep = 0; BranceStep < 3; BranceStep ++){

                    for(var drink = -1; drink < AbilityName.length; drink++){
                        if(drink != -1){
                            if(ddrinklist[drink] == 1)  continue;
                        }
                        SeedBrance = copyobj(SeedOri);
                        for(var temp = 0; temp < BranceStep + 1; temp++){
                            SeedBrance.GetNextAbility(drink);
                            ResStep[OriginStep + temp] = copyobj(SeedBrance);
                        }
                        
                        var matchc = Matchcode(SeedBrance.Ability, TargetCode);


                        if(matchc[0] != -2 ){

                        //    //test
                        //     IDtable0  = document.getElementById('IDtable0');
                        //     var tab = '<p>' + TargetCode[0] + ' ' +TargetCode[1] + ' ' +TargetCode[2] + ' ' + ' </p>';
                        //     IDtable0.innerHTML = tab;

                        //     //test
                        //     IDtable0  = document.getElementById('IDtable1');
                        //     var tab = '<p>' + matchc[0] + ' ' +matchc[1] + ' ' +matchc[2] + ' ' + ' </p>';
                        //     IDtable0.innerHTML = tab;

                            var Cost = SeedFindNN(SeedBrance, drink, matchc);
                            if (Cost[0] == -2)  continue;

                            // //test
                            // IDtable0  = document.getElementById('IDtable2');
                            // var tab = '<p>' + matchc[0] + ' ' +matchc[1] + ' ' +matchc[2] + ' ' + ' </p>';
                            // IDtable0.innerHTML = tab;
                            // return;
                            

                            CostNum = CostNumCalcu(drink, Cost, OriginStep, BranceStep);
                            if(CostNum[1] == CostNum[2] && CostNum[1] == CostNum[3] && BranceStep > 1)    continue;
                            if(CostNum[0] >= CostNumP) continue;
                            CostNumP = CostNum[0];
                            ResStep[OriginStep + BranceStep + 1] = copyobj(SeedBrance.GetNextAbility(CostNum[2]));
                            ResStep[OriginStep + BranceStep + 2] = copyobj(SeedBrance.GetNextAbility(CostNum[3]));
                            //out
                            if(IsFindAll == 1){
                                var newtr = document.createElement("tr");
                                if(TargetCode[2] == -1)
                                    var tbd = document.getElementById('table1');
                                else
                                    var tbd = document.getElementById('table0');
                                tbd.appendChild(newtr);

                                var newtd = document.createElement("td");
                                newtd.innerHTML =  "<img src = 'icon/skill/" + TargetCode[0] + ".png' style = 'width:25px;background-color:black;' > " + AbilityName[TargetCode[0]];
                                newtr.appendChild(newtd);
                                
                                var newtd = document.createElement("td");
                                if(TargetCode[2] == -1)
                                    newtd.innerHTML = (OriginStep + BranceStep + 2);
                                else
                                newtd.innerHTML = (OriginStep + BranceStep + 3);
                                newtr.appendChild(newtd);

                                var newtd = document.createElement("td");
                                newtd.innerHTML = CostNum[0];
                                newtr.appendChild(newtd);

                                if(CostNum[1] > -1 && CostNum[1] < 14){
                                    var newtd = document.createElement("td");
                                    newtd.innerHTML = "<img src = 'icon/skill/" + CostNum[1] + ".png' style = 'width:25px;background-color:black;' > " + AbilityName[CostNum[1]] + ' 飲料';
                                    newtr.appendChild(newtd);
                                }
                                if(CostNum[2] > -1 && CostNum[2] < 14 && CostNum[2] != CostNum[1]){
                                    var newtd = document.createElement("td");
                                    newtd.innerHTML = "<img src = 'icon/skill/" + CostNum[2] + ".png' style = 'width:25px;background-color:black;' > " +AbilityName[CostNum[2]] + ' 飲料';
                                    newtr.appendChild(newtd);
                                }
                                if(CostNum[3] > -1 && CostNum[3] < 14 && CostNum[2] != CostNum[3]){
                                    var newtd = document.createElement("td");
                                    newtd.innerHTML = "<img src = 'icon/skill/" + CostNum[3] + ".png' style = 'width:25px;background-color:black;' > " +AbilityName[CostNum[3]] + ' 飲料';
                                    newtr.appendChild(newtd);
                                }
                                // var newtd = document.createElement("td");
                                // var newtn = document.createElement("a");
                                // newtn.innerText = ' 查找方案 ';
                                // newtn.href = "#";
                                // newtn.value = TargetCode;
                                // newtn.onclick = function (){
                                    
                                //     MainFunction();
                                //     return ;
                                // }
                                // newtd.appendChild(newtn);
                                // newtr.appendChild(newtd);
                                return;
                            }
                            else if(drinkjump == -1){
                                IDtable0  = document.getElementById('IDtable' + tablenum);
                                tablenum ++;
                                var tab='<table class = "table" >'
                                tab = tab + "<thead><tr> <td>編號</td><td >技能</td><td >種子</td></tr></thead><tbody>"
                                
                                for(let temp = 0; temp < OriginStep; temp++){
                                    tab += '<tr>';
                                    tab += "<td >" + (temp + 1) + "</td>";
                                    tab += "<td >" +"<img src = 'icon/skill/" + ResStep[temp].Ability + ".png' style = 'width:25px;background-color:black;'> "+ AbilityName[ResStep[temp].Ability] + "</td>";
                                    tab += "<td >0x" + ResStep[temp].Seed.toString(16) + "</td>";
                                    tab += '</tr>';
                                }

                                if(CostNum[1] >-1 && CostNum[1] < 14){
                                        tab += '<tr><th colspan = "3">' + '喝 ' +"<img src = 'icon/skill/" + CostNum[1] + ".png' style = 'width:25px;background-color:black;' > " + AbilityName[CostNum[1]]  + ' 飲料' + '</td> </tr>';
                                }

                                for(let temp = OriginStep; temp < OriginStep + BranceStep; temp++){
                                    tab += '<tr>';
                                    tab += "<td >" + (temp + 1) + "</td>";
                                    tab += "<td >"+"<img src = 'icon/skill/" + ResStep[temp].Ability + ".png' style = 'width:25px;background-color:black;'> " + AbilityName[ResStep[temp].Ability]  + "</td>";
                                    tab += "<td >0x" + ResStep[temp].Seed.toString(16) + "</td>";
                                    tab += '</tr>';
                                }
                                tab += '<tr><th colspan = "3">' + "接下來就是目標序列，0.3的記得洗衣服，0.2的記得打孔" + '</th> </tr>'

                                tab += '<tr>';
                                tab += "<td >" + (OriginStep + BranceStep + 1) + "</td>";
                                tab += "<td >"+"<img src = 'icon/skill/" + ResStep[OriginStep + BranceStep].Ability + ".png' style = 'width:25px;background-color:black;' > " + AbilityName[ResStep[OriginStep + BranceStep].Ability]  + "</td>";
                                tab += "<td >0x" + ResStep[OriginStep + BranceStep].Seed.toString(16) + "</td>";
                                tab += '</tr>';

                                if(CostNum[2] != CostNum[1]){
                                    if((CostNum[2] == -1 || CostNum[2] == 14) && (CostNum[1] != -1 && CostNum[1] != 14))
                                        tab += '<tr><th colspan = "3">' + "取消飲料效果" + '</td> </tr>';
                                    else if((CostNum[2] == -1 || CostNum[2] == 14) && (CostNum[1] == -1 || CostNum[1] == 14)){
                                        tab = tab;
                                    }else
                                        tab += '<tr><th colspan = "3">' + '喝 '+"<img src = 'icon/skill/" + CostNum[2] + ".png' style = 'width:25px;background-color:black;' > "+ AbilityName[CostNum[2]] + ' 飲料' + '</td> </tr>';
                                }
                                tab += '<tr>';
                                tab += "<td >" + (OriginStep + BranceStep + 2) + "</td>";
                                tab += "<td >"+"<img src = 'icon/skill/" + ResStep[OriginStep + BranceStep + 1].Ability + ".png' style = 'width:25px;background-color:black;'> " + AbilityName[ResStep[OriginStep + BranceStep + 1].Ability]  + "</td>";
                                tab += "<td >0x" + ResStep[OriginStep + BranceStep + 1].Seed.toString(16) + "</td>";
                                tab += '</tr>';
                                if(TargetCodeNum(TargetCode) == 3){
                                    if(CostNum[3] != CostNum[2]){
                                        if(CostNum[3] == -1 || CostNum[3] == 14 &&(CostNum[2] != -1 && CostNum[2] != 14))
                                            tab += '<tr><th colspan = "3">' + "取消飲料效果" + '</td> </tr>';
                                        else if((CostNum[2] == -1 || CostNum[2] == 14) && (CostNum[3] == -1 || CostNum[3] == 14)){
                                            tab = tab;
                                        }else
                                            tab += '<tr><th colspan = "3">' + '喝 ' +"<img src = 'icon/skill/" + CostNum[3] + ".png' style = 'width:25px;background-color:black;' > " + AbilityName[CostNum[3]] + ' 飲料' + '</td> </tr>';
                                    }
                                    tab += '<tr>';
                                    tab += "<td >" + (OriginStep + BranceStep + 3) + "</td>";
                                    tab += "<td >"+"<img src = 'icon/skill/" + ResStep[OriginStep + BranceStep + 2].Ability + ".png' style = 'width:25px;background-color:black;'> " + AbilityName[ResStep[OriginStep + BranceStep + 2].Ability]  + "</td>";
                                    tab += "<td >0x" + ResStep[OriginStep + BranceStep + 2].Seed.toString(16) + "</td>";
                                    tab += '</tr>';
                                }

                                tab += '</tbody></table>';
                                IDtable0.innerHTML = tab;
                            }else{
                                IDtable0  = document.getElementById('IDtable' + tablenum);
                                tablenum ++;
                                var tab='<table class = "table" >';
                                var tempjudge = -1;
                                var judgejudge = -1;
                                tab = tab + "<thead><tr> <td>編號</td><td >技能</td><td >種子</td></tr></thead><tbody>"
                                tab += '<tr><th colspan = "3">' + '喝 ' +"<img src = 'icon/skill/" + drinkjump + ".png' style = 'width:25px;background-color:black;' > " + AbilityName[drinkjump] + ' 飲料' + '</td> </tr>';
                                tab += '<tr><th colspan = "3">' + '該飲料是為了縮短序列，請保持飲料狀態直到下次提示' + '</td> </tr>';
                                tab += '<tr><th colspan = "3">' + '此功能可能還有bug，請一定要在lean的網站上驗證一下' + '</td> </tr>';
                                var tempseed = copyobj(Seed);
                                //var tempseedbefor = copyobj(Seed);
                                for(let temp = 0; temp < OriginStep + BranceStep + 2; temp++){
                                    tempseed.GetNextAbility(drinkjump);
                                    if(tempseed.Seed == ResStep[OriginStep + BranceStep].Seed && tempseed.Ability == ResStep[OriginStep + BranceStep].Ability){
                                        tempjudge = temp;
                                        //alert(tempjudge + ' ' + tempseed.Seed.toString(16) + ' ' + ResStep[OriginStep + BranceStep].Seed.toString(16));
                                        break;
                                    }else if(tempseed.Seed == ResStep[OriginStep + BranceStep].Seed){
                                        tempjudge = temp - BranceStep ;
                                        //alert(tempjudge);
                                        judgejudge = 2;
                                        break;
                                    }
                                    //tempseedbefor = copyobj(temps)
                                }
                                //alert(tempjudge);
                                //alert('yes' + tempjudge + '  0x'+ ResStep[OriginStep + BranceStep].Seed.toString(16) + '  ' + temp);
                                var tempt = OriginStep + BranceStep;
                                while(tempjudge == -1){
                                    tempt = tempt - 1;
                                    var tempseed = copyobj(Seed);
                                    for(let temp = 0; temp < OriginStep + BranceStep; temp++){
                                        tempseed.GetNextAbility(drinkjump);
                                        if(tempseed.Seed == ResStep[tempt].Seed){
                                            tempjudge = temp + 1;
                                            judgejudge = 1;
                                            //alert(tempjudge);
                                            break;
                                        }
                                    }
                                }

                                var tempseed = copyobj(Seed);
                                for(let temp = 0; temp < tempjudge; temp++){
                                    tempseed.GetNextAbility(drinkjump);
                                    tab += '<tr>';
                                    tab += "<td >" + (temp + 1) + "</td>";
                                    tab += "<td >"+"<img src = 'icon/skill/" + tempseed.Ability + ".png' style = 'width:25px;background-color:black;'> " + AbilityName[tempseed.Ability]  + "</td>";
                                    tab += "<td >0x" + tempseed.Seed.toString(16) + "</td>";
                                    tab += '</tr>';
                                }


                                if(judgejudge == 2){
                                    tab += '<tr><th colspan = "3">' + "取消飲料效果" + '</td> </tr>';
                                    tab += '<tr>';
                                    tab += "<td >" + (tempjudge + 1) + "</td>";
                                    tab += "<td >" +"<img src = 'icon/skill/" + ResStep[OriginStep - 1].Ability + ".png' style = 'width:25px;background-color:black;'> "+ AbilityName[ResStep[OriginStep - 1].Ability] + "</td>";
                                    tab += "<td >0x" + ResStep[OriginStep - 1].Seed.toString(16) + "</td>";
                                    tab += '</tr>';


                                    if(CostNum[1] > -1 && CostNum[1] < 14){
                                        tab += '<tr><th colspan = "3">' + '喝 '+"<img src = 'icon/skill/" + CostNum[1] + ".png' style = 'width:25px;background-color:black;' > "+ AbilityName[CostNum[1]] + ' 飲料' + '</td> </tr>';
                                    }
                                    for(let temp =0; temp < BranceStep; temp++){
                                        tab += '<tr>';
                                        tempjudge ++;
                                        tab += "<td >" + (tempjudge + 1) + "</td>";
                                        tab += "<td >" +"<img src = 'icon/skill/" + ResStep[temp + OriginStep].Ability + ".png' style = 'width:25px;background-color:black;'> "+ AbilityName[ResStep[temp + OriginStep].Ability] + "</td>";
                                        tab += "<td >0x" + ResStep[temp + OriginStep].Seed.toString(16) + "</td>";
                                        tab += '</tr>';
                                    }
                                    tempjudge++;
                                }
                                if(judgejudge == 1){
                                    tab += '<tr><th colspan = "3">' + "取消飲料效果" + '</td> </tr>';
                                }else if(CostNum[1] < 0 || CostNum[1] > 13){
                                    tab += '<tr><th colspan = "3">' + "取消飲料效果" + '</td> </tr>';
                                }
                                

                                for(let temp = tempjudge; temp < tempjudge + OriginStep - tempt - 1; temp++){
                                    tempseed.GetNextAbility(-1);
                                    tab += '<tr>';
                                    tab += "<td >" + (temp + 1) + "</td>";
                                    tab += "<td >"+"<img src = 'icon/skill/" + tempseed.Ability + ".png' style = 'width:25px;background-color:black;'> " + AbilityName[tempseed.Ability]  + "</td>";
                                    tab += "<td >0x" + tempseed.Seed.toString(16) + "</td>";
                                    tab += '</tr>';
                                }
                                tempjudge = tempjudge + OriginStep - tempt - 1;
                                if(CostNum[1] > -1 && CostNum[1] < 14 && judgejudge != 2){
                                    tab += '<tr><th colspan = "3">' + '喝 '+"<img src = 'icon/skill/" + CostNum[1] + ".png' style = 'width:25px;background-color:black;' > "+ AbilityName[CostNum[1]] + ' 飲料' + '</td> </tr>';
                                }

                                tab += '<tr><th colspan = "3">' + "接下來就是目標序列，0.3的記得洗衣服，0.2的記得打孔" + '</th> </tr>'
                                tab += '<tr>';
                                tab += "<td >" + (tempjudge + 1) + "</td>";
                                tab += "<td >"+"<img src = 'icon/skill/" + ResStep[OriginStep + BranceStep].Ability + ".png' style = 'width:25px;background-color:black;' > " + AbilityName[ResStep[OriginStep + BranceStep].Ability]  + "</td>";
                                tab += "<td >0x" + ResStep[OriginStep + BranceStep].Seed.toString(16) + "</td>";
                                tab += '</tr>';
                                if(CostNum[2] != CostNum[1]){
                                    if((CostNum[2] == -1 || CostNum[2] == 14) && (CostNum[1] != -1 && CostNum[1] != 14))
                                        tab += '<tr><th colspan = "3">' + "取消飲料效果" + '</td> </tr>';
                                    else if((CostNum[2] == -1 || CostNum[2] == 14) && (CostNum[1] == -1 || CostNum[1] == 14)){
                                        tab = tab;
                                    }else
                                        tab += '<tr><th colspan = "3">' + '喝 '+"<img src = 'icon/skill/" + CostNum[2] + ".png' style = 'width:25px;background-color:black;' > "+ AbilityName[CostNum[2]] + ' 飲料' + '</td> </tr>';
                                }
                                tab += '<tr>';
                                tab += "<td >" + (tempjudge + 2) + "</td>";
                                tab += "<td >"+"<img src = 'icon/skill/" + ResStep[OriginStep + BranceStep + 1].Ability + ".png' style = 'width:25px;background-color:black;'> " + AbilityName[ResStep[OriginStep + BranceStep + 1].Ability]  + "</td>";
                                tab += "<td >0x" + ResStep[OriginStep + BranceStep + 1].Seed.toString(16) + "</td>";
                                tab += '</tr>';
                                if(TargetCodeNum(TargetCode) == 3){
                                    if(CostNum[3] != CostNum[2]){
                                        if(CostNum[3] == -1 || CostNum[3] == 14 &&(CostNum[2] != -1 && CostNum[2] != 14))
                                            tab += '<tr><th colspan = "3">' + "取消飲料效果" + '</td> </tr>';
                                        else if((CostNum[2] == -1 || CostNum[2] == 14) && (CostNum[3] == -1 || CostNum[3] == 14)){
                                            tab = tab;
                                        }else
                                            tab += '<tr><th colspan = "3">' + '喝 ' +"<img src = 'icon/skill/" + CostNum[3] + ".png' style = 'width:25px;background-color:black;' > " + AbilityName[CostNum[3]] + ' 飲料' + '</td> </tr>';
                                    }
                                    tab += '<tr>';
                                    tab += "<td >" + (tempjudge + 3) + "</td>";
                                    tab += "<td >"+"<img src = 'icon/skill/" + ResStep[OriginStep + BranceStep + 2].Ability + ".png' style = 'width:25px;background-color:black;'> " + AbilityName[ResStep[OriginStep + BranceStep + 2].Ability]  + "</td>";
                                    tab += "<td >0x" + ResStep[OriginStep + BranceStep + 2].Seed.toString(16) + "</td>";
                                    tab += '</tr>';
                                }

                                tab += '</tbody></table>';
                                IDtable0.innerHTML = tab;
                            }
                        }
                    }
                }
                SeedOri.GetNextAbility(-1);
                ResStep[OriginStep] = copyobj(SeedOri);
            }
        }

        function copyobj(Seed){
            var Seedres = new GearAbility(Seed.Ability, Seed.Seed, Seed.Brand);
            return Seedres;
        }

        function AddTable(){
            var drinkdonthave = parseInt(document.getElementById('DrinkDontHave').value);
            var tabtoadd = document.getElementById('drinktable');
            var newtr = document.createElement("tr");
            tabtoadd.appendChild(newtr);
            var newtd = document.createElement("td");

            if(drinkdonthave == -1){
                alert("請輸入飲料券");
                return ;
            } 

            if(drinkdonthave == 100){
                for(let i = 0; i< 14;i++){
                    if(ddrinklist[i] == 1){
                        alert("選擇禁用飲料請把其他所有飲料刪除");
                        return;
                    }
                }
                for(let i = 0; i < 14;i++){
                    ddrinklist[i] = 1;
                }
                newtd.innerHTML = '飲料已禁用';
                newtr.appendChild(newtd);
                MainFunction();
                var newtd = document.createElement("td");
                var delbtn = document.createElement("a");
                
                delbtn.innerText = ' 刪除 ';
                delbtn.href = "#";
                delbtn.onclick = function (){
                    for(let i = 0 ; i < 15; i++){
                        ddrinklist[i] = 0;
                    }
                    tabtoadd.removeChild(this.parentNode.parentNode);
                    MainFunction();
                    return ;
                }
                newtd.appendChild(delbtn);
                newtr.appendChild(newtd);
                return;
            }

            if(ddrinklist[drinkdonthave] == 0){
                ddrinklist[drinkdonthave] = 1;
            }else{
                alert("請不要輸入相同飲料");
                return;
            }

            
            newtd.innerHTML = AbilityName[drinkdonthave];
            newtr.appendChild(newtd);

            var newtd = document.createElement("td");
            var delbtn = document.createElement("a");
            MainFunction();
            delbtn.innerText = ' 刪除 ';
            delbtn.href = "#";
            delbtn.onclick = function (){
                for(let temp = 0;temp < 14;temp ++){
                    if(this.parentNode.parentNode.innerHTML == "<td>" + AbilityName[temp] + '</td><td><a href="#"> 刪除 </a></td>'){
                        ddrinklist[temp] = 0;
                    }
                    if(this.parentNode.parentNode.innerHTML == "<td>" + '禁用飲料' + '</td><td><a href="#"> 刪除 </a></td>'){
                        for(let i = 0; i< 14; i++){
                            ddrinklist[temp] = 1;
                        }
                    }
                }
                tabtoadd.removeChild(this.parentNode.parentNode);
                MainFunction();
            }
            newtd.appendChild(delbtn);
            newtr.appendChild(newtd);

        }

        function newtarget(){
            TargetCode[0] = parseInt(document.getElementById('IDTarget1').value);
            TargetCode[1] = parseInt(document.getElementById('IDTarget2').value);
            TargetCode[2] = parseInt(document.getElementById('IDTarget3').value);
        }
        function MainFunction(){
            cleartable();

            var SeedMain = new GearAbility;
            SeedMain.Seed = parseInt(document.getElementById('IDSeed').value);
            SeedMain.Seed = SeedMain.Seed >>> 0;
            SeedMain.Brand = parseInt(document.getElementById('IDClothes').value);

            
            var Result = new Array();
            // TargetCode[0] = parseInt(document.getElementById('IDTarget1').value);
            // TargetCode[1] = parseInt(document.getElementById('IDTarget2').value);
            // TargetCode[2] = parseInt(document.getElementById('IDTarget3').value);

            if(TargetCode[0] == -1 && TargetCode[1] == -1 && TargetCode[2] == -1){

                IDtable0  =document.getElementById('IDtable0');
                var tab='<table class = "table"  id = "table0">';
                tab += "<thead> <tr> <td >0.3的技能</td><td >所需步驟</td><td >所需飲料數量</td><td >飲料1</td><td >飲料2</td><td >飲料3</td></tr> </thead><tbody></tbody>";
                tab += '</table>';
                IDtable0.innerHTML = tab;
                for(let temp = 0; temp < 14; temp++){
                    TargetCode[0] = temp;
                    TargetCode[1] = temp;
                    TargetCode[2] = temp;
                    tab = SeedFind(SeedMain, TargetCode, 1);
                }
                
                IDtable0  =document.getElementById('IDtable1');
                var tab='<table class = "table"  id = "table1">';
                tab += "<thead> <tr> <td >0.2的技能</td><td >所需步驟</td><td >所需飲料數量</td><td >飲料1</td><td >飲料2</td> </tr> </thead><tbody></tbody>";
                tab += '</table>';
                IDtable0.innerHTML = tab;
                for(let temp = 0; temp < 14; temp++){
                    TargetCode[0] = temp;
                    TargetCode[1] = temp;
                    TargetCode[2] = -1;
                    tab = SeedFind(SeedMain, TargetCode, 1);
                }

            }else{
                SeedFind(SeedMain, TargetCode, 0);
            }
        }
    </script>
    <style>
        .ability0{
            background: url('icon/brand/B00.png');
            padding-left: 20px; 
        }

        a {
            text-decoration:underline;
        }
        a:hover {
            color: #b8a5f5;
        }
        table {
            border-collapse: collapse;
            margin-top: 50px;
            margin-bottom: 100px;
            margin-left: 20px;
            margin-right: 20px;
            border: 1px;
    
        }
        .table2 {
            border-collapse: collapse;
            margin-top: 5px;
            margin-bottom: 5px;
            margin-left: 20px;
            margin-right: 20px;
            border: 1px;
        }
        table th{
            border: 1px solid black;
            text-align: center;
            background-color: rgb(255, 240, 220);
        }
        table td{
            border: 1px solid black;

            text-align: center;
        }
        body {
            background-color: #e9ecef;
            width: 90%;
            padding: 4rem 2rem;
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;
        }
        .wrapper {
            background-color: #fff;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 1rem;
            margin-top: 10px;
        }
        table tr.header, table tr:hover {
            /* 表頭及鼠標移動過 tr 時添加背景 */
            background-color: #f1f1f1;
        }
        </style>
    <body>
       

        
        <div class = "content">
            <div class="wrapper">
            <h1>噴噴噴技能序列搜索器</h1>
                <a href="index.html">切換简体中文</a>
                <p>歡迎使用本網站，這裏有<strong>教程與問過的問題</strong>，有問題可以參考一下，如果還無法解決可以聯系我：<a href="Tutorial.html">教程與更新公告</a></p>
				<p><strong><u>註意：請一定要看一下各個選項的介紹與註意事項，並且使用方案之前請去lean大佬的網站驗證一下路線，有bug請及時反饋</u></strong></p>
                <p>此網站是用來輔助尋找自己想要的技能的</p>
                <p>此網站由我一人完成，並且我之前並沒有學過JS，如有bug實屬正常</p>
                <p>如果有bug或有建議請反饋給我qq:1464243589</p>
                <p>在使用我的方案之前請去lean大佬的網站復查一下</p>
                <p>ps.lean大佬的網站也增加了搜索目標序列的功能，結果和我的是差不多的，可以去試試</p>
		    </div>

            <div class = "wrapper">
            <h2>請輸入衣服種子</h2>
                <p>求種子的網站在<a href="https://leanny.github.io/splat3seedchecker/#/seedrecover">這裏</a></p>
                <input type = "text" id = "IDSeed" value = "0x915cfc31"/>
            </div>

            <form method="post" action=" ">
                <div class = "wrapper">
                <h2>請選擇衣服品牌</h2>
                <p>
                  <select id="IDClothes">
                      <option value= '0' selected label="戰鬥魷魚 / SquidForce" class = "ability0" >戰鬥魷魚 / SquidForce</option>
                      <option value= '1' label="鋼鐵先鋒 / Zink" class = "ability0">鋼鐵先鋒 / Zink</option>
                      <option value= '2' label="海月 / Krak-On">海月 / Krak-On</option>
                      <option value= '3' label="羅肯貝格 / Rockenberg">羅肯貝格 / Rockenberg</option>
                      <option value= '4' label="澤酷 / Zekko">澤酷 / Zekko</option>
                      <option value= '5' label="鍛品 / Forge">鍛品 / Forge</option>
                      <option value= '6' label="暖流 / Firefin">暖流 / Firefin</option>
                      <option value= '7' label="帆立 / Skalop">帆立 / Skalop</option>
                      <option value= '8' label="寺門 / Splash Mob">寺門 / Splash Mob</option>
                      <option value= '9' label="時雨 / Inkline">時雨 / Barazushi</option>
                      <option value= '10' label="艾洛眼 / Tentatek">艾洛眼 / Tentatek</option>
                      <option value= '11' label="暇古 / Takoroka">暇古 / Takoroka</option>
                      <option value= '12' label="無法無天 / Annaki">無法無天 / Annaki</option>
                      <option value= '13' label="魷皇 / Enperry">魷皇 / Enperry</option>
                      <option value= '14' label="劍尖魷 / Toni Kensa">劍尖魷 / Toni Kensa</option>
                      <option value= '15' label="散壽司 / Barazushi">散壽司 / Barazushi</option>
                      <option value= '16' label="七輪 / Emberz">七輪 / Emberz</option>
                      <option value= '17' label="熊先生商會 / Grizzco">熊先生商會 / Grizzco</option>
                      <option value= '18' label="魚幹製造 / Cuttlegear">魚幹製造 / Cuttlegear</option>
                      <option value= '19' label="amiibo">amiibo</option>
                  </select>
                </p>
                </div>
            </form>

            <div class = "wrapper">
                <h3>請輸入沒有的飲料，將在搜索的時候避開這些飲料</h3>
                <p>可以輸入多個飲料，但是請不要重復輸入</p>
                    <select id="DrinkDontHave">
                        <option value= '-1' >無</option>
                        <option value= '0' >主省 / 提升墨汁效率(主要武器)</option>
                        <option value= '1' >副省 / 提升墨汁效率(次要武器)</option>
                        <option value= '2' >墨回 / 提升墨汁槽的回復速度</option>
                        <option value= '3' >走速 / 提升人類狀態移動速度</option>
                        <option value= '4' >遊速 / 提升魷魚遊動速度</option>
                        <option value= '5' >大招減量 / 提升特殊武器增加量</option>
                        <option value= '6' >sp死亡減輕 / 降低特殊武器減少量</option>
                        <option value= '7' >大招增強 / 提升特殊武器的性能</option>
                        <option value= '8' >快速復活 / 縮短復活時間</option>
                        <option value= '9' >超級跳 / 縮短超級跳躍的時間</option>
                        <option value= '10' >副強 / 提升次要武器的性能</option>
                        <option value= '11' >安全鞋 / 減輕對手墨汁影響</option>
                        <option value= '12' >防爆 / 減輕次要武器影響</option>
                        <option value= '13' >行動強化</option>
                        <option value= '100' >禁用飲料</option>
                    </select>
                    <input  id="button" type="button" value="添加" onclick="AddTable();">
                    <table class = "table2", id="drinktable"> <head> <tr> <td> 沒有的飲料券 </td> <td>  操作  </td> </tr></head> </table>
            </div>

            <div class = "wrapper">
            <h3>請輸入想用來縮短搜索序列的飲料</h3>
            <p>目標序列之前的序列可以使用氪多余的飲料的方法跳過某些種子，請選擇使用什麽飲料跳過：</p>
            <p><strong>註意</strong>：海螺刷新技能是無飲料影響，因此使用本功能只能手刷，並且盡量保持在方案提示的範圍內每個技能生成的時候都處於飲料期間，有自己的方案規劃請自行去lean的網站驗證，並且飲料只有在技能生成的時候有作用，前面的經驗積累過程中無影響</p>
            <p><strong>註意</strong>：此功能不會影響到全技能距離對比表，預計使用此功能平均可減少35%的序列長度</p>
            <p><strong>註意</strong>：此功能可能還有bug,使用之前請一定要去lean大佬的網站<strong>驗證一下</strong></p>
            <select id="DrinkJump">
                <option value= '-1' >不使用飲料跳過</option>
                <option value= '0' >主省 / 提升墨汁效率(主要武器)</option>
                <option value= '1' >副省 / 提升墨汁效率(次要武器)</option>
                <option value= '2' >墨回 / 提升墨汁槽的回復速度</option>
                <option value= '3' >走速 / 提升人類狀態移動速度</option>
                <option value= '4' >遊速 / 提升魷魚遊動速度</option>
                <option value= '5' >大招減量 / 提升特殊武器增加量</option>
                <option value= '6' >sp死亡減輕 / 降低特殊武器減少量</option>
                <option value= '7' >大招增強 / 提升特殊武器的性能</option>
                <option value= '8' >快速復活 / 縮短復活時間</option>
                <option value= '9' >超級跳 / 縮短超級跳躍的時間</option>
                <option value= '10' >副強 / 提升次要武器的性能</option>
                <option value= '11' >安全鞋 / 減輕對手墨汁影響</option>
                <option value= '12' >防爆 / 減輕次要武器影響</option>
                <option value= '13' >行動強化</option>
            </select>
            </div>

            <div class = "wrapper">
                <h3>請輸入目標序列</h3>
                <p>可以只輸入兩個目標序列，需要將最後一個位置選<strong>未知</strong>，輸入0.2的目的是在0.2出來<strong>之前用10碎片打技能</strong></p>
                <p><strong>三個序列位置都為未知</strong>時將輸出所有技能的0.3和0.2消耗</p>
                <p>ps.增加了<strong>無序搜索</strong>的功能，會從序列排列組合的結果中挑選最優解</p>
                    <select id="IDTarget1">
                        <option value= '-1' >未知</option>
                        <option value= '0' >主省 / 提升墨汁效率(主要武器)</option>
                        <option value= '1' >副省 / 提升墨汁效率(次要武器)</option>
                        <option value= '2' >墨回 / 提升墨汁槽的回復速度</option>
                        <option value= '3' >走速 / 提升人類狀態移動速度</option>
                        <option value= '4' >遊速 / 提升魷魚遊動速度</option>
                        <option value= '5' >大招減量 / 提升特殊武器增加量</option>
                        <option value= '6' >sp死亡減輕 / 降低特殊武器減少量</option>
                        <option value= '7' >大招增強 / 提升特殊武器的性能</option>
                        <option value= '8' >快速復活 / 縮短復活時間</option>
                        <option value= '9' >超級跳 / 縮短超級跳躍的時間</option>
                        <option value= '10' >副強 / 提升次要武器的性能</option>
                        <option value= '11' >安全鞋 / 減輕對手墨汁影響</option>
                        <option value= '12' >防爆 / 減輕次要武器影響</option>
                        <option value= '13' >行動強化</option>
                    </select>
                    <select id="IDTarget2">
                        <option value= '-1' >未知</option>
                        <option value= '0' >主省 / 提升墨汁效率(主要武器)</option>
                        <option value= '1' >副省 / 提升墨汁效率(次要武器)</option>
                        <option value= '2' >墨回 / 提升墨汁槽的回復速度</option>
                        <option value= '3' >走速 / 提升人類狀態移動速度</option>
                        <option value= '4' >遊速 / 提升魷魚遊動速度</option>
                        <option value= '5' >大招減量 / 提升特殊武器增加量</option>
                        <option value= '6' >sp死亡減輕 / 降低特殊武器減少量</option>
                        <option value= '7' >大招增強 / 提升特殊武器的性能</option>
                        <option value= '8' >快速復活 / 縮短復活時間</option>
                        <option value= '9' >超級跳 / 縮短超級跳躍的時間</option>
                        <option value= '10' >副強 / 提升次要武器的性能</option>
                        <option value= '11' >安全鞋 / 減輕對手墨汁影響</option>
                        <option value= '12' >防爆 / 減輕次要武器影響</option>
                        <option value= '13' >行動強化</option>
                    </select>
                    <select id="IDTarget3">
                        <option value= '-1' >未知</option>
                        <option value= '0' >主省 / 提升墨汁效率(主要武器)</option>
                        <option value= '1' >副省 / 提升墨汁效率(次要武器)</option>
                        <option value= '2' >墨回 / 提升墨汁槽的回復速度</option>
                        <option value= '3' >走速 / 提升人類狀態移動速度</option>
                        <option value= '4' >遊速 / 提升魷魚遊動速度</option>
                        <option value= '5' >大招減量 / 提升特殊武器增加量</option>
                        <option value= '6' >sp死亡減輕 / 降低特殊武器減少量</option>
                        <option value= '7' >大招增強 / 提升特殊武器的性能</option>
                        <option value= '8' >快速復活 / 縮短復活時間</option>
                        <option value= '9' >超級跳 / 縮短超級跳躍的時間</option>
                        <option value= '10' >副強 / 提升次要武器的性能</option>
                        <option value= '11' >安全鞋 / 減輕對手墨汁影響</option>
                        <option value= '12' >防爆 / 減輕次要武器影響</option>
                        <option value= '13' >行動強化</option>
                    </select>
            </div>


            <div class = "wrapper">
            <p>要是沒有輸出，說明在40步以內找不到對應序列，建議放棄</p>
            <p>輸出的方案並不唯一，按照消耗飲料券的從多到少顯示最少步驟的方案，最多可能有四個方案</p>
            <input  id="button" type="button" value="生成方案" onclick="newtarget();MainFunction();">
            <div id = "IDtable0"></div>
            <div id = "IDtable1"></div>
            <div id = "IDtable2"></div>
            <div id = "IDtable3"></div>
            <div id = "IDtable4"></div>
            <div id = "IDtable5"></div>
            <div id = "IDtable6"></div>
            <div id = "IDtable7"></div>
            <div id = "IDtable8"></div>
            </div>
        </div>
    </body>
</html>

